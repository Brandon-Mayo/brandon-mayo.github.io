"0","crash %>% "
"0","  filter(!is.na(injuries), crash_month %in% c(1, 12)) %>% "
"0","  mutate("
"0","    day_of_week = wday(crash_date, label = TRUE, abbr = TRUE),"
"0","    injuries = factor(injuries, levels = c(""none"", ""injuries""), ordered = TRUE)"
"0","  ) %>% "
"0","  group_by(day_of_week, injuries) %>% "
"0","  summarize(count = n()) %>% "
"0","  ungroup(injuries) %>% "
"0","  mutate("
"0","    rel_freq = count / sum(count),"
"0","    label_y = 1 - cumsum(rel_freq) + rel_freq / 2,"
"0","    tooltip_text = paste(""Day of Week: "", day_of_week, ""<br>Injuries: "", injuries, ""<br>Total Crashes: "", count, ""<br>Percentage:"", scales::percent(rel_freq, accuracy=.01))"
"0","  ) %>% "
"0","  plot_ly("
"0","    x = ~day_of_week,"
"0","    y = ~rel_freq,"
"0","    type = ""bar"","
"0","    color = ~injuries,"
"0","    colors = c(""#66c2a5"", ""#fc8d62""),  # Adjust colors as needed"
"0","    text = ~tooltip_text,"
"0","    hoverinfo = ""text"""
"0","  ) %>%"
"0","  layout("
"0","    yaxis = list(title = ""Relative Frequency""),"
"0","    xaxis = list(title = """"),"
"0","    title = ""Percentage of Injuries Relative to Each Day"""
"0","  )"
"2","`summarise()` has grouped output by 'day_of_week'. You can override using the `.groups` argument."
