"0","crash %>% "
"0","  filter(!is.na(injuries), crash_month %in% c(1,12)) %>% "
"0","  mutate(day_of_week=wday(crash_date, label=T, abbr=T),"
"0","         injuries=factor(injuries, levels=c(""none"",""injuries""), ordered=T)) %>% "
"0","  group_by(day_of_week, injuries) %>% "
"0","  summarize(count=n()) %>% "
"0","  ungroup(injuries) %>% "
"0","  mutate(rel_freq=count/sum(count), label_y=1-cumsum(rel_freq)+rel_freq/2) %>% "
"0","  ggplot("
"0","    aes(x=day_of_week,y=rel_freq, fill=injuries)) +"
"0","  geom_bar(stat=""identity"", alpha=.8) +"
"0","  scale_fill_brewer(palette=""Set1"", direction=-1) +"
"0","  geom_text(aes(y= label_y, label=percent(rel_freq, accuracy = .01)), color=""White"") +"
"0","  scale_y_continuous(labels=scales::percent) +"
"0","  labs(x=NULL, y=""Relative Frequency"", title=""Percentage of Injuries Relative to Each Day"")"
"2","`summarise()` has grouped output by 'day_of_week'. You can override using the `.groups` argument."
