"0","flights <- read.csv(""rawflight.csv"")"
"0",""
"0","airports <- read.csv(""airports.csv"")"
"0",""
"0","clean_ports <- airports %>% "
"0","  transmute("
"0","    airport_id, name, state, city"
"0","  ) %>% "
"0","  mutate(OriginAirportID=airport_id, OriginAirportID=as.numeric(OriginAirportID)) %>% "
"0","  mutate(DestAirportID=airport_id, DestAirportID=as.numeric(DestAirportID))"
"0",""
"0","clean_flights <- flights %>% "
"0","  transmute(week_day=wday(DayOfWeek, label=T, abbr=T),"
"0","            Carrier, DepDelay, ArrDelay, OriginAirportID, DestAirportID) %>%"
"0","  mutate(OriginAirportID=as.numeric(OriginAirportID), DestAirportID=as.numeric(DestAirportID))"
"0",""
"0","ave_delays_states <- clean_flights %>%"
"0","  group_by(OriginAirportID) %>%"
"0","  summarize(ave_departure_delay = mean(DepDelay, na.rm = TRUE)) %>%"
"0","  left_join(clean_ports, by = c(""OriginAirportID"" = ""airport_id"")) %>%"
"0","  ungroup() %>% "
"0","  group_by(state) %>%"
"0","  slice_max(ave_departure_delay, n = 2)"
"0",""
